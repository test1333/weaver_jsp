select?*?from?(select??fnumber,fyear,sum(famount)?as?famount?from?(select?reverse(substring(reverse(a.FNumber),1,charindex('.',reverse(a.FNumber))?-?1))?as?fnumber,b.FAmount,c.fyear??from?t_Account??a,?t_VoucherEntry?b,t_voucher?c?where???a.FAccountID=b.FAccountID?and??b.FVoucherID?=c.fvoucherid?and??a.fnumber?like?'1604.%'?and?b.fvoucherid?not?in(select?fvoucherid?from?t_VoucherEntry?where?FAccountID=5715??))?t?group?by?t.fnumber,t.fyear
)??a?where?a.fnumber='2016094' 